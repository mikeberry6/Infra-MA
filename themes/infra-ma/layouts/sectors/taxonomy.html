{{ define "main" }}
{{ $sectorName := .Data.Singular | default .Title }}
{{ $sectorColor := "#555" }}
{{ $subsectors := slice }}
{{ with .Site.Data.sectors }}
  {{ $sector := index . $sectorName }}
  {{ with $sector }}
    {{ $sectorColor = .color }}
    {{ $subsectors = .subsectors }}
  {{ end }}
{{ end }}

<section class="page-hero" style="--env-color: {{ $sectorColor }}; --env-glow: {{ $sectorColor }}22">
  <div class="container">
    <a href="{{ "sectors/" | relURL }}" class="back-link" style="color: var(--text-secondary)">&larr; All Sectors</a>
    <p class="page-hero-eyebrow">Sector</p>
    <h1 class="page-hero-title"><span class="page-hero-title-accent">{{ .Title }}</span></h1>
    {{ with $subsectors }}
    <div style="display: flex; flex-wrap: wrap; gap: var(--space-2); margin-top: var(--space-4);">
      {{ range . }}
      <span class="chip" style="border-color: {{ $sectorColor }}; color: {{ $sectorColor }};">{{ . }}</span>
      {{ end }}
    </div>
    {{ end }}
    <div class="page-hero-divider"></div>
  </div>
</section>

<section class="section">
  <div class="container">
    {{ if .Pages }}
    <p class="results-count">{{ len .Pages }} deals</p>
    <div class="deal-grid">
      {{ range .Pages.ByDate.Reverse }}
        {{ partial "deal-card.html" . }}
      {{ end }}
    </div>
    {{ else }}
    <div class="empty-state">
      <div class="empty-state-icon">&#x1F3D7;</div>
      <h3 class="empty-state-title">No deals in this sector yet</h3>
      <p>Check back after the next weekly update.</p>
    </div>
    {{ end }}
  </div>
</section>
{{ end }}
